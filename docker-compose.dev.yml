version: '3.8'

# Simplified Docker Compose for local development
# Usage: docker-compose -f docker-compose.dev.yml up

services:
  oneiric:
    build:
      context: .
      dockerfile: Dockerfile
    image: oneiric:dev
    container_name: oneiric-dev
    restart: "no"  # Don't auto-restart in development

    # Environment variables
    environment:
      - ONEIRIC_CONFIG=/app/settings
      - LOG_LEVEL=DEBUG  # Verbose logging for development
      - ONEIRIC_LOG_FORMAT=console  # Human-readable logs

    # Volumes - mount source code for live editing
    volumes:
      # Mount source code (for live development)
      - ./oneiric:/app/oneiric:ro
      - ./settings:/app/settings:ro
      - oneiric-dev-cache:/app/.oneiric_cache
      - ./logs:/app/logs

    # Ports
    ports:
      - "8000:8000"

    # Override default command for development
    command: ["python", "-m", "oneiric.cli", "list", "--domain", "adapter"]

    # Networks
    networks:
      - oneiric-dev

    # No resource limits in development
    # No health checks in development

networks:
  oneiric-dev:
    driver: bridge

volumes:
  oneiric-dev-cache:
    driver: local
